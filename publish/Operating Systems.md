# Areas of Improvement
- Offer suggestions

# Components

## Process Scheduling
### Non-preemptive
- Resources allocated until process completes execution
### Preemptive
- Resources allocated for fixed time

### Process Control Blocks (PCB)
#### Data Structure
- Process State
- PID
- Registers
- Memory Limits
- Open Files

- PCBs of particular process states placed in their respective queues
    - **Job Queue**: All processes
    - **Ready Queue**: In memory waiting to execute
    - **Device Queue**: Blocked due to unavailability of an I/O device

### Scheduler
#### Job
- Loads from queue into memory
#### CPU
- Change P state (ready -> running)
#### Swapping
- Suspended P (e.g. waiting for I/O) swapped out of memory
- Can reintroduce into memory

### Context Switching
- Restore register, memory state of CPU in PCB to resume process from same point

### Algos
- FCFS, SJN, Priority Scheduling, SRT, Round Robin, Multiple-level Queue, etc.

## Memory Management
### Memory Division
#### Pages: Fixed-size blocks
#### Segments: Variable-size logical units

### Virtual Memory
- Use SD as memory
    - Swap Space: Area reserved

## File System Management
- Organize files, metadata hierarchically in directories - easy access
- File data storage allocation

### Encryption
- During storage and transit

### Authorization
#### Discretionary Access Control (DAC)
- Manages user permissions (rwx)
- Defined in Access Control Lists

## Security
### Authentication
- Verifies identity
- Username - password login, biometrics, SSH keys

### Authorization
#### SELinux
- Implements Mandatory Access Control (MAC) at kernel level
- Establish roles and permissions for users and processes, overriding DAC based on resource ownership
- Enforces security policies that restrict access to system resources (e.g. Port access for applications)

#### Firewall
- Block incoming traffic based on rich rules
    - e.g. block traffic on specific port from certain services/IPs

## Device Management
### Kernel Modules
#### Drivers
- Hardware devices -> Interrupt Request (IRQ)
- Register Interrupt Service Routine (ISR)
    - Handle interrupts generated by their respective devices
    - Perform minimal processing and defer extensive processing, to quickly return control to the interrupted process
    - with Interrupt Controller
        - ICs for prioritizing IRQs for CPU
        - APIC, MSI Controller
- Device Drivers
    - CPU, Network Drivers
- File System Drivers
    - Manage I/O and buffering
    - NTFS

#### Pluggable Authentication Modules (PAM)
- Provide framework for integrating authentication methods into applications

#### Network Protocol Modules
- TCP/IP, UDP

#### Security Modules - Linux Security Modules (LSM)
- Provide hooks for security decisions - file/network operations, process executions
- SELinux

### Kernel Services
- Manage software interrupts
    - Exception Handling
    - System calls
        - e.g. read(), write(), getpid(), time(), pipe(), socket(), exec(), wait()
        - Processor Mode switch - user to kernel mode (OS core functions)
        - Execute privileged operation
        - Return to user mode

## Hypervisor
- Used to create VM
    - **Type 1 - Bare metal**
        - VMware ESXi
    - **Type 2**
        - VMware Workstation

## Container
- Isolated, controlled, reproducible environment
- Share kernel of host OS
    - For incompatible host kernel, Docker Desktop virtualizes kernel inside lightweight VM or uses prebuilt solution (WSL2)

### Base Image
- OS Userspace utilities
    - App Dependencies
        - Binaries
        - Libraries
        - Config Files

### App

## Boot Process
### Power ON
- CPU fetches reset vector from Firmware ROM
    - Reset vector: Points CPU to the start of firmware execution

### Firmware
- **BIOS**
    - POST (Power On Self-Test)
        - Checks CPU, RAM, MoBo, I/O devices
        - If successful:
            - Locates bootable media
        - Else:
            - Stops and Beep/LED codes - error message
    - Load boot sector from SD
    - **MBR** - 512 bytes data structure stored in LBA 0
        - Contains:
            - Bootstrap loader - scans partition table for a primary partition marked bootable mounted on /boot
            - Partition table
            - Disk signature
    - Loads bootloader

- **UEFI**
    - SEC (Security Initialization)
    - PEI (Pre-EFI Initialization)
    - DXE (Driver Execution Environment)
    - BDS (Boot Device Selection)
    - Reads GPT header & partition table @ LBA 2 and ESP
        - LBA 0 Protective MBR
        - LBA 1 Primary GPT Header - defines partitioning scheme
        - LBA 2 Stores primary partition table
        - Backup header and PT at the end of the disk
    - **ESP (EFI System Partition - FAT32)** mounted on /boot/efi
        - .efi executable files
            - bootloader (systemd-boot, GRUB2)
            - Secure boot ensures only signed .efi are executed
    - Loads bootloader

### Bootloader
- **GRUB**
    - Reads /boot
    - /efi/EFI/redhat/grub.cfg
        - Boot menu
        - Command line parameters
            - Can even customize kernel behavior
    - Loads into RAM
        - **vmlinuz** (supports virtual memory)
        - **initramfs img**

- **systemd-boot**
    - /boot/efi/EFI/systemd/systemd-bootx64.efi
    - Boot menu
    - Loads vmlinuz and initramfs into RAM and hands over execution

### Kernel
- vmlinuz contains a small stub (decompression code) that extracts itself
- Initializes:
    - **CPU**:
        - Configures CPU registers
        - Sets up exception and interrupt handling mechanisms
    - **Memory**:
        - Physical
        - Virtual
    - Device detection
        - Storage controllers
        - Network Interfaces
        - Peripherals
- Load modules (e.g. drivers) compiled into kernel
    - Initialized during boot
- Mounts temporary RAM-based filesystem (tmpfs) as /
- Extracts initramfs img into /
- Executes /init script
    - Loads modules (e.g. Intel/AMD microcode)
    - Mounts SD / as Read-only for consistency checks, then remounts it as RW and switches to it
    - Executes PID 1 (/sbin/init, sym-linked to /usr/lib/systemd/systemd)

### Init System
- /etc/fstab invoked
    - Filesystem Table - mounts defined filesystems on boot
    - Device Mount_point Filesystem Options Dump Pass
        - Dump - Backup
        - Pass - check fs first or later
- Manages services based on targets (systemd) or runlevels (older init system)
    - Reads unit files in /usr/lib/systemd/system and /etc/systemd/system
    - Executes them in order

#### Systemd Targets
- 0: poweroff.target
- 1: rescue.target (Getty - single-user mode for minimal maintenance)
- 2-4: multi-user.target (Multi-user mode)
- 5: graphical.target (GUI)
- 6: reboot.target (Reboot)

- Show currently loaded targets/runlevel:
    - `systemctl list-units --type=target`
    - `runlevel`

- Temporarily switch target:
    - `systemctl isolate name.target`
    - `init #`

- Permanent target:
    - `systemctl get-default`
    - `systemctl set-default name.target`

### Namespaces
- Isolate processes within their own environments

### Control groups (cgroups)
- Manage system resources distribution amongst processes

## User Login & Session Management
- Init loads shell GUI/CLI shell
    - Shell initializes user-specific configurations

## Win
### CLI (Terminal Emulators)
- Windows Terminal
### Shell
- PowerShell
#### Corporate License
- Employees/competitors can report unlicensed software to organizations like BSA through their channels for investigation and potential enforcement actions

### Software vendors often engage intermediary audit firms, such as KPMG, whose compliance and regulatory officers conduct audits to ensure corps comply with software license agreements

## Linux
### Multiple distributions
- Individual maintainers/orgs
- Different package managers
    - Packages hosted on org servers
    - Easy update and install through shell instead of searching for binaries

### Kernel
- Analogous to UNIX kernel written from scratch
- Originally developed by Linus Torvalds, written in C
- Rust used for new modules
- Originally hosted on Git
    - Now on GitLab
    - Has a GitHub repo without active commits

### File Systems
| File System | Crash Protection   | Data Integrity Checks  | Snapshots | Built-in RAID Support | Use Case               |
|-------------|---------------------|------------------------|-----------|-----------------------|-------------------------------------|
| **ext4**    | Journaling          | None                   | No        | No                    | Small-med file RW, Desktops         |
| **Btrfs**   | Copy-on-Write (COW) | Checksumming           | Yes       | Yes                   | Desktops                            |
| **XFS**     | Journaling          | Metadata Checksums     | No        | No                    | Large file servers                  |
| **ZFS**     | Copy-on-Write (COW) | End-to-End Checksums   | Yes       | Yes                   | High-capacity servers, data centers |

#### ext4
- Linux File System
    - Directories stored as files -> point to inodes -> point to data blocks

### RAID
- Redundant Array of Independent Disks
- Data redundancy, performance
    - Hardware
        - RAID controller
    - Software
        - Linux software RAID
        - LVM RAID

## Directory Structure
- /
    - **Root**
        - /bin: User command binaries
        - /boot: Bootloader and kernel files
        - /etc: Config/setting files
        - /sbin: System binaries        
        - /usr: Read-only app data and binaries
        - /var: Variable data files
        - /dev: Device files
        - /home: User home directories
        - /lib: Libraries and kernel modules
        - /mnt: Temporary mount point for external file systems
        - /opt: Optional software applications
        - /proc: Virtual file system for system and process info
        - /root: Root user home directory
        - /sys: System and hardware information
        - /tmp: Temporary files

## CLI (Terminal Emulators)
- Terminal app 
    - e.g. Gnome Terminal

### Shell
- Userspace interface to interact with applications
    - Interactive: User can enter commands
    - Non-interactive: `/sbin/nologin`

### Login
- Loads user environment
### Non-login
- Loads only global config without user environment

## GNU Utils
- FOSS utilities analogous to UNIX OS in function written from scratch

## Commands
- `command -f --flag arguments`
   

